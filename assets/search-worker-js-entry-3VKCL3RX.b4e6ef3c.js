import{T as I,f as b,_ as g,s as ee,K as h,p as w,b as te,m as S,r as re,c as ae,d as ne,i as ie,g as B,h as U,j as K,A as q,M as G,k as p,Q as M,l as oe}from"./index.c13cb735.js";import{e as se}from"./search-worker-ts-entry-J3TDBCMV.bbdb5d70.js";var A=class extends I{constructor(e){super(),this.metric=e}traverseAlg(e){let t=0;for(const r of e.childAlgNodes())t+=this.traverseAlgNode(r);return t}traverseGrouping(e){const t=e.alg;return this.traverseAlg(t)*Math.abs(e.amount)}traverseMove(e){return this.metric(e)}traverseCommutator(e){return 2*(this.traverseAlg(e.A)+this.traverseAlg(e.B))}traverseConjugate(e){return 2*this.traverseAlg(e.A)+this.traverseAlg(e.B)}traversePause(e){return 0}traverseNewline(e){return 0}traverseLineComment(e){return 0}};function $(e){return"A"<=e&&e<="Z"}function ce(e){const t=e.family;return $(t[0])&&t[t.length-1]==="v"||t==="x"||t==="y"||t==="z"||t==="T"?0:1}function ue(e){return 1}function le(e){const t=e.family;return $(t[0])&&t[t.length-1]==="v"||t==="x"||t==="y"||t==="z"||t==="T"?0:Math.abs(e.amount)}var P=new A(ce),me=P.traverseAlg.bind(P),de=new A(ue);P.traverseAlg.bind(de);var z=new A(le);z.traverseAlg.bind(z);var fe=class extends I{traverseAlg(e){let t=0;for(const r of e.childAlgNodes())t+=this.traverseAlgNode(r);return t}traverseGrouping(e){return this.traverseAlg(e.alg)*Math.abs(e.amount)}traverseMove(e){return 1}traverseCommutator(e){return 2*(this.traverseAlg(e.A)+this.traverseAlg(e.B))}traverseConjugate(e){return 2*this.traverseAlg(e.A)+this.traverseAlg(e.B)}traversePause(e){return 1}traverseNewline(e){return 0}traverseLineComment(e){return 0}},R=new fe;R.traverseAlg.bind(R);var ve=2;function we(e,t){const r=[];return t.forEach(function(n){const i=new G(n);if(i.amount!==1)throw new Error("SGS cannot handle def moves with an amount other than 1 yet.");let a=e.identityTransformation();for(let o=1;a=a.applyMove(i),!a.isIdentityTransformation();o++)r.push({move:i.modified({amount:o}),transformation:a})}),r}var x=class{constructor(e,t,r){this.kpuzzle=e,this.sgs=t,this.searchMoves=we(this.kpuzzle,r??Object.keys(this.kpuzzle.definition.moves))}async solve(e,t=ve,r){const n=e.experimentalToTransformation();if(!n)throw new Error("distinguishable pieces are not supported in tremble solver yt");let i=null,a=1e6;const o=(c,l,u)=>{if(l===0){const m=this.sgsPhaseSolve(c,a);if(!m)return;const d=u.concat(m).simplify({collapseMoves:!0,quantumMoveOrder:r}),v=me(d);(i===null||v<a)&&(i=d,a=v);return}for(const m of this.searchMoves)o(c.applyTransformation(m.transformation),l-1,u.concat([m.move]))};for(let c=0;c<=t;c++)o(n,c,new p);if(i===null)throw new Error("SGS search failed.");return i}sgsPhaseSolve(e,t){const r=new q;let n=e;for(const i of this.sgs.ordering){const a=i.pieceOrdering;let o="";const c=n.invert();for(let u=0;u<a.length;u++){const m=a[u],d=m.orbitName,v=m.permutationIdx;o+=` ${c.transformationData[d].permutation[v]} ${c.transformationData[d].orientation[v]}`}const l=i.lookup[o];if(!l)throw new Error("Missing algorithm in sgs or esgs?");if(r.experimentalPushAlg(l.alg),r.experimentalNumAlgNodes()>=t)return null;n=n.applyTransformation(l.transformation);for(let u=0;u<a.length;u++){const m=a[u],d=m.orbitName,v=m.permutationIdx;if(n.transformationData[d].permutation[v]!==v||n.transformationData[d].orientation[v]!==0)throw new Error("bad SGS :-(")}}return r.toAlg()}};async function V(e,t){const r=await K();let n=e.identityTransformation();for(const i of t.ordering){const a=r(Object.values(i.lookup));n=n.applyTransformation(a.transformation)}return n.toKState()}var f=b(()=>g(()=>import("./search-dynamic-sgs-side-events-ZTOWSMQT.b8c59f27.js"),["assets/search-dynamic-sgs-side-events-ZTOWSMQT.b8c59f27.js","assets/chunk-NJPSC7SH.1bb769a9.js","assets/index.c13cb735.js","assets/index.873ea6aa.css","assets/chunk-ROGN5SXC.40d11c29.js"])),Se=3,O=null;async function W(){return O||(O=(async()=>{const e=await(await f).cachedData222();return new x(await w["2x2x2"].kpuzzle(),e,"URFLBD".split(""))})())}async function he(){await W()}async function j(e){return S(),await(await W()).solve(e,Se,()=>4)}async function be(e,t,r,n){const i=await U();await oe(r.stateData[t].pieces);const a=e.definition.orbits[t],o=r.stateData[t].orientation;let c=0;for(let l=0;l<a.numPieces;l++){const u=i(a.numOrientations);o[l]=u,c+=u}n&&"orientationSum"in n&&(o[0]=((o[0]+n.orientationSum-c)%a.numOrientations+a.numOrientations)%a.numOrientations)}async function ge(){const e=await w["2x2x2"].kpuzzle(),t=new h(e,JSON.parse(JSON.stringify(e.startState().stateData)));return await be(e,"CORNERS",t,{orientationSum:0}),t}async function ye(){return await j(await ge())}var H=b(()=>g(()=>import("./search-dynamic-solve-4x4x4-YH6SB2WB.171ee443.js"),["assets/search-dynamic-solve-4x4x4-YH6SB2WB.171ee443.js","assets/index.c13cb735.js","assets/index.873ea6aa.css"])),pe=[[null,"x","x2","x'","z","z'"],[null,"y","y2","y'"]];async function xe(){return(await H).initialize()}async function J(){return(await H).random444Scramble()}async function Me(){return B(await J(),pe)}function _e(e){switch(e){case 5:return 60;case 6:return 80;default:return 100}}var Te=[["U","D"],["L","R"],["F","B"]],D=new Map;function Ee(e){const t=D.get(e);if(t)return t;const r=[];for(const n of Te){const i=[];r.push(i);for(const a of n){i.push(new M(a)),e>3&&i.push(new M(`${a}w`));for(let o=3;o<=e/2;o++)i.push(new M(`${a}w`,o))}}return D.set(e,r),r}async function y(e){const t=await U(),r=await K(),n=r,i=Ee(e),a=_e(e),o=new q;let c=0;const l=new Set;for(;o.experimentalNumAlgNodes()<a;){const u=t(3);u!==c&&l.clear(),c=u;const m=r(i[c]),d=m.toString();l.has(d)||(l.add(d),o.push(new G(m,n([1,2,-1]))))}return o.toAlg()}var Pe=[[null,"3Rw","3Rw2","3Rw'","3Fw","3Fw'"],[null,"3Dw","3Dw2","3Dw'"]];async function Ae(){return B(await y(5),Pe)}var ze=b(()=>g(()=>import("./search-dynamic-solve-fto-O6UXF7EC.60e08af8.js"),["assets/search-dynamic-solve-fto-O6UXF7EC.60e08af8.js","assets/index.c13cb735.js","assets/index.873ea6aa.css"]));b(()=>g(()=>import("./search-dynamic-sgs-unofficial-V6HZTLGM.17d6a5e0.js"),["assets/search-dynamic-sgs-unofficial-V6HZTLGM.17d6a5e0.js","assets/chunk-NJPSC7SH.1bb769a9.js","assets/index.c13cb735.js","assets/index.873ea6aa.css"]));async function Re(){return S(),new p(await(await ze).randomFTOScrambleString())}var Oe=b(()=>g(()=>import("./search-dynamic-solve-kilominx-ZPEOK4DY.805f8d6a.js"),["assets/search-dynamic-solve-kilominx-ZPEOK4DY.805f8d6a.js","assets/index.c13cb735.js","assets/index.873ea6aa.css"]));async function De(){return S(),(await Oe).getRandomKilominxScramble()}var Ce=b(()=>g(()=>import("./search-dynamic-solve-master_tetraminx-3RKD3IAN.b570291c.js"),["assets/search-dynamic-solve-master_tetraminx-3RKD3IAN.b570291c.js","assets/index.c13cb735.js","assets/index.873ea6aa.css"]));async function ke(){return S(),new p(await(await Ce).randomMasterTetraminxScrambleString())}var Fe=2,C=null;async function Le(){return C||(C=(async()=>{const e=await(await f).cachedSGSDataMegaminx();return new x(await(await f).cachedMegaminxKPuzzleWithoutMO(),e,["U","R","F","L","BR","BL","FR","FL","DR","DL","B","D"])})())}async function Ne(e){S();const t=await Le(),r=JSON.parse(JSON.stringify(e.stateData));r.CENTERS.orientation=new Array(12).fill(0);const n=new h(await(await f).cachedMegaminxKPuzzleWithoutMO(),r);return await t.solve(n,Fe,()=>5)}var Ie=3,k=null;async function Be(){return k||(k=(async()=>{const e=await(await f).sgsDataPyraminx();return new x(await w.pyraminx.kpuzzle(),e,"RLUB".split(""))})())}async function Q(e){return S(),await(await Be()).solve(e,Ie,()=>3)}async function Ue(){return S(),V(await w.pyraminx.kpuzzle(),await(await f).sgsDataPyraminxFixedOrientation())}async function Ke(){return Q(await Ue())}var qe=b(()=>g(()=>import("./search-dynamic-sgs-unofficial-V6HZTLGM.17d6a5e0.js"),["assets/search-dynamic-sgs-unofficial-V6HZTLGM.17d6a5e0.js","assets/chunk-NJPSC7SH.1bb769a9.js","assets/index.c13cb735.js","assets/index.873ea6aa.css"]));async function Ge(){return S(),(await qe).getRandomRediCubeScramble()}var $e=3,F=null;async function Ve(){return F||(F=(async()=>{const e=await(await f).sgsDataSkewb();return new x(await(await f).skewbKPuzzleWithoutMOCached(),e,"RLUB".split(""))})())}function We(e){return new h(e.kpuzzle,{CORNERS:e.stateData.CORNERS,CENTERS:{pieces:e.stateData.CENTERS.pieces,orientation:new Array(6).fill(0)}})}async function Z(e){return S(),await(await Ve()).solve(We(e),$e,n=>n.family==="y"?4:3)}async function je(){return V(await(await f).skewbKPuzzleWithoutMOCached(),await(await f).sgsDataSkewbFixedCorner())}async function He(){return Z(await je())}var Je=b(()=>g(()=>import("./search-dynamic-solve-sq1-WIJEGVLP.6967b4d5.js"),["assets/search-dynamic-solve-sq1-WIJEGVLP.6967b4d5.js","assets/index.c13cb735.js","assets/index.873ea6aa.css"]));async function Qe(){return p.fromString(await(await Je).getRandomSquare1ScrambleString())}var Ze=1e3;ee(!0);var X=!0;function Xe(e){X=e}function L(){return(typeof performance>"u"?Date:performance).now()}async function s(e,t,r){if(!X)return t();const n=L(),i=t();i?.then&&await i;const a=L();return console.warn(`${e}${r?.isPrefetch?" (prefetched)":""}: ${Math.round(a-n)}ms`),i}var _=new Map,T=null;async function N(e,t){switch(e){case"222":return s("random222Scramble",ye,{isPrefetch:t?.isPrefetch});case"333":case"333oh":case"333ft":return s("random333Scramble",ne,{isPrefetch:t?.isPrefetch});case"333fm":return s("random333FewestMovesScramble",ae);case"333bf":case"333mb":return s("random333OrientedScramble",re);case"444":return s("random444Scramble",J,{isPrefetch:t?.isPrefetch});case"444bf":return s("random444OrientedScramble",Me);case"555":return s("bigCubeScramble(5)",y.bind(y,5));case"555bf":return s("oriented555RandomMoves",Ae);case"666":return s("bigCubeScramble(6)",y.bind(y,6));case"777":return s("bigCubeScramble(7)",y.bind(y,7));case"skewb":return s("randomSkewbFixedCornerScramble",He);case"pyram":return s("randomPyraminxScrambleFixedOrientation",Ke);case"sq1":return s("getRandomSquare1Scramble",Qe,{isPrefetch:t?.isPrefetch});case"fto":return s("randomFTOScramble",Re,{isPrefetch:t?.isPrefetch});case"master_tetraminx":return s("randomMasterTetraminxScramble",ke);case"kilominx":return s("randomKilominxScramble",De,{isPrefetch:t?.isPrefetch});case"redi_cube":return s("randomRediCubeScramble",Ge,{isPrefetch:t?.isPrefetch});default:throw new Error(`unsupported event: ${e}`)}}var E="auto",Y={initialize:async e=>{switch(e){case"222":return s("preInitialize222",he);case"333":case"333oh":case"333ft":return s("initialize333",ie);case"444":return s("initialize444",xe);default:throw new Error(`unsupported event: ${e}`)}},setScramblePrefetchLevel(e){E=e},randomScrambleForEvent:async e=>{let t=_.get(e);return t?_.delete(e):t=N(e),E!=="none"&&t.then(()=>{T&&clearTimeout(T),T=setTimeout(()=>{_.set(e,N(e,{isPrefetch:!0}))},E==="immediate"?0:Ze)}),t},randomScrambleStringForEvent:async e=>(await Y.randomScrambleForEvent(e)).toString(),solve333ToString:async e=>{const t=new h(await w["3x3x3"].kpuzzle(),e);return(await te(t)).toString()},solve222ToString:async e=>{const t=new h(await w["2x2x2"].kpuzzle(),e);return(await j(t)).toString()},solveSkewbToString:async e=>{const t=new h(await w.skewb.kpuzzle(),e);return(await Z(t)).toString()},solvePyraminxToString:async e=>{const t=new h(await w.pyraminx.kpuzzle(),e);return(await Q(t)).toString()},solveMegaminxToString:async e=>{const t=new h(await w.megaminx.kpuzzle(),e);return(await Ne(t)).toString()},setDebugMeasurePerf:async e=>{Xe(e)}};se(Y);
